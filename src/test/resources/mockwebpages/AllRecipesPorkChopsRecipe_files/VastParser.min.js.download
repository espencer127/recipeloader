/*! Kargo Vast Parser - v1.13.4 */
!function(e){function r(a){if(t[a])return t[a].exports;var n=t[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){var a=t(1),n=t(2),i=t(4),s=t(5),l=t(6),o=a.getTopWindow(window),c=a.getPageUrl(o),u=/^https:/.test(c),p=new l(i,s,{upgradeToHttps:u}),d=new n(p),g=o;g.Kargo=g.Kargo||{},g.Kargo.VastParser=d,e.exports=d},function(e,r){function t(e){for(var r="krg-nobust",t=e,a=e.top;t!==a;){var n;try{n=t.parent.location.href}catch(e){n=!1}if(!n)break;for(var i,s=t.parent.document.getElementsByTagName("iframe"),l=null,o=0;o<s.length;o+=1)if(i=s[o],i.contentWindow===t){l=i;break}if(l){var c=l.className.split(" ");if(c.indexOf(r)>-1)break}t=t.parent}return t}function a(e){var r;try{r=e.location.href}catch(e){return""}return e.AMP_LISTENING&&e.context&&e.context.sourceUrl?r=e.context.sourceUrl:n(e)&&e.document.referrer?r=e.document.referrer:i(r,"content_url")&&(r=i(r,"content_url")),r}function n(e){var r;try{r=e.top.location.href}catch(e){r=null}return!r}function i(e,r){var t=r+"=(.+?)(&|$)";return decodeURIComponent((new RegExp(t,"i").exec(e)||["",""])[1])}e.exports={getTopWindow:t,getPageUrl:a}},function(e,r,t){var a=t(3),n=function(e){this.parser=e};n.prototype.parseUrl=function(e,r){this.parser.parseUrl(e,r)},n.prototype.parseString=function(e,r){this.parser.parse(e,r)},n.prototype.replaceVastMacros=function(e,r){return a.replace(e,r)},e.exports=n},function(e,r){var t={};t.replace=function(e,r){r=r||{};var t=e,a=function(e,r){for(var t=e.toString();t.length<r;)t="0"+t;return t},n=r.errorCode?r.errorCode.toString():"";t=t.replace(/\[errorcode\]/gi,encodeURIComponent(n));var i=r.contentPlayHead||"";t=t.replace(/\[contentplayhead\]/gi,encodeURIComponent(i));var s=r.assetUri||"";t=t.replace(/\[asseturi\]/gi,encodeURIComponent(s)),t=t.replace(/\[cachebusting\]/gi,function(e){for(var r="",t=8;t>0;)r+=Math.floor(10*Math.random()).toString(),t-=1;return encodeURIComponent(r)});var l=new Date,o=l.getTimezoneOffset()/60,c=o<0?o.toString():"+"+o.toString(),u=l.getFullYear().toString()+"-"+a(l.getMonth()+1,2)+"-"+a(l.getDate(),2)+"T"+a(l.getHours(),2)+":"+a(l.getMinutes(),2)+":"+a(l.getSeconds(),2)+"."+a(l.getMilliseconds(),3)+c;return t=t.replace(/\[timestamp\]/gi,encodeURIComponent(u))},e.exports=t},function(e,r){var t=function(e){this.element=e};t.parse=function(e,r){if("string"==typeof e){var a=null,n=null;if(DOMParser&&DOMParser.prototype.parseFromString){var i=new DOMParser;n=i.parseFromString(e,"text/xml")}else{for(var s=/<!\[CDATA\[(.*?)\]\]>/g,l=null;l=s.exec(e);)l[1]=l[1].replace(/&/g,"&amp;"),l[1]=l[1].replace(/</g,"&lt;"),l[1]=l[1].replace(/>/g,"&gt;"),l[1]=l[1].replace(/"/g,"&quot;"),l[1]=l[1].replace(/'/g,"&#039;"),e=e.replace(l[0],l[1]);e=e.replace(/<(\w+)([^>]*)\/>/g,"<$1 $2></$1>"),n=document.implementation.createHTMLDocument("").body,n.innerHTML=e}if(n.childNodes.length)a=new t(n.childNodes[0]),r(null,a);else{var o=new Error("No HTML Elements found in Input String");r(o,null)}}else{var o=new Error("Input was not recognized as string or HTMLElement");r(o,null)}},t.prototype.getAttribute=function(e){var r=null;if(e=e.toLowerCase(),this.element.attributes)for(var t=this.element.attributes,a=0;a<t.length;a++)if(t[a].name.toLowerCase()===e){r=t[a].value;break}return r},t.prototype.getChildren=function(e){var r=[],a=this.element.children;a=Array.prototype.slice.call(a);for(var n=0;n<a.length;n++)e?a[n].tagName.toLowerCase()==e.toLowerCase()&&r.push(new t(a[n])):r.push(new t(a[n]));return r},t.prototype.getValue=function(){var e=this.element.textContent;return e=e.replace(/\n|\r/g,""),e=e.trim()},t.prototype.getTagName=function(){return this.element.tagName.toLowerCase()},e.exports=t},function(e,r){var t={};t.getUrl=function(e,r,a){if(void 0!==a&&null!==a||(a=!1),"string"!=typeof e||!e.length){var n=new Error("Invalid Url");return void r(n,null)}var i=new XMLHttpRequest,s=!1,l=function(){if(!s)if(s=!0,a){var n=new Error("VAST URL Request Failed - "+e);r(n,null)}else t.getUrl(e,r,!0)};i.withCredentials=a,i.addEventListener("load",function(){200==i.status?r(null,i.responseText):l()}),i.addEventListener("error",function(){l()}),i.open("GET",e,!0),i.send()},e.exports=t},function(e,r,t){var a=t(3),n={Vast:t(7),Ad:t(8),Creative:t(9)},i=function(e,r,t){this.external={HTMLElement:e,Request:r},this.options=t||{},void 0===this.options.upgradeToHttps&&(this.options.upgradeToHttps=!1)};i.prototype.createElement=function(e,r){this.external.HTMLElement.parse(e,r)},i.prototype.requestUrl=function(e,r){var t=e;this.options.upgradeToHttps&&(t=this.upgradeToHttps(t)),t=a.replace(t),this.external.Request.getUrl(t,r)},i.prototype.parse=function(e,r){var t=this,a=function(e){t.generateUUID(e),r(null,e)},i=e;this.options.upgradeToHttps&&(i=this.upgradeToHttps(i));var s=null;if(!/^<VAST[\s\S]*?<\/VAST>$/i.test(e)){var l=/^([\s\S]*?)(<VAST[\s\S]*?<\/VAST>)([\s\S]*?)$/i.exec(e);l&&(e=l[2],s=l[1]+l[3])}t.createElement(e,function(e,l){if(e)return void r(e,null);var o=n.Vast.parse(l);if(o.addedHTML=s,o.rawXmlResults=[i],o.adNode){if(o.ad=n.Ad.parse(o.adNode),delete o.adNode,o.ad.creativeNodes.length){o.ad.creatives={};for(var c=0;c<o.ad.creativeNodes.length;c++){var u=o.ad.creativeNodes[c],p=n.Creative.parse(u);switch(p.type){case"linear":o.ad.creatives.linear=p;break;case"companion":o.ad.creatives.companion=p}}delete o.ad.creativeNodes}"wrapper"===o.ad.type&&o.ad.wrappers.length?t.parseUrl(o.ad.wrappers[o.ad.wrappers.length-1],function(e,n){e?r(e,null):(t.mergeWrapper(n,o),a(n))}):a(o)}else a(o)})},i.prototype.parseUrl=function(e,r){var t=this;t.requestUrl(e,function(e,a){e?r(e,null):t.parse(a,r)})},i.prototype.mergeWrapper=function(e,r){if(e.ad=e.ad||{},r.ad=r.ad||{},e.ad.adverifications=(e.ad.adverifications||[]).concat(r.ad.adverifications||[]),e.ad.viewabletracker=(e.ad.viewabletracker||[]).concat(r.ad.viewabletracker||[]),e.ad.error=(e.ad.error||[]).concat(r.ad.error||[]),e.ad.impression=(e.ad.impression||[]).concat(r.ad.impression||[]),e.ad.extensions&&r.ad.extensions)for(key in r.ad.extensions)e.ad.extensions.hasOwnProperty(key)?e.ad.extensions[key]=r.ad.extensions[key].concat(e.ad.extensions[key]):e.ad.extensions[key]=r.ad.extensions[key];e.ad.creatives=e.ad.creatives||{},r.ad.creatives=r.ad.creatives||{},r.ad.creatives.linear&&(e.ad.creatives.linear?(e.ad.creatives.linear.trackingEvents=n.Creative.mergeTracking(e.ad.creatives.linear.trackingEvents,r.ad.creatives.linear.trackingEvents),e.ad.creatives.linear.videoClicks=n.Creative.mergeVideoClicks(e.ad.creatives.linear.videoClicks,r.ad.creatives.linear.videoClicks)):e.ad.creatives.linear=r.ad.creatives.linear),e.ad.wrappers=(e.ad.wrappers||[]).concat(r.ad.wrappers||[]),e.rawXmlResults=(e.rawXmlResults||[]).concat(r.rawXmlResults||[])},i.prototype.generateUUID=function(e){e.uuid||(e.uuid=null,(((e.ad||{}).creatives||{}).linear||{}).universalAdId?e.uuid=e.ad.creatives.linear.universalAdId:e.ad&&e.ad.id?(e.ad.system?e.uuid=e.ad.system+"-"+e.ad.id:e.uuid="Generic-Ad-"+e.ad.id,e.ad.creatives&&e.ad.creatives.linear&&(e.ad.creatives.linear.id?e.uuid+="-"+e.ad.creatives.linear.id:e.ad.creatives.linear.adId&&(e.uuid+="-"+e.ad.creatives.linear.adId))):e.ad&&e.ad.title&&(e.ad.system?e.uuid=e.ad.system+"-"+e.ad.title:e.uuid=e.ad.title))},i.prototype.upgradeToHttps=function(e){var r=e.replace(/http:/g,"https:");return r.indexOf("yahoo.com")&&(r=r.replace("secure/false","secure/true")),r},e.exports=i},function(e,r){var t={};t.parse=function(e){var r={version:null,adNode:null},t=e.getAttribute("version");t&&(r.version=t);var a=e.getChildren("Ad");return a.length&&(r.adNode=a[0]),r},e.exports=t},function(e,r){var t={};t.parse=function(e){var r={adverifications:[],id:null,type:null,system:null,title:null,impression:[],error:[],extensions:{},creativeNodes:[],creatives:{linear:null},wrappers:[]},t=e.getAttribute("id");t&&(r.id=t);var a=e.getChildren();if(a.length){var n=a[0];"inline"==n.getTagName()?r.type="inline":"wrapper"==n.getTagName()&&(r.type="wrapper");var i=n.getChildren();if(i.length)for(var s=0;s<i.length;s++){var l=i[s];switch(l.getTagName()){case"adsystem":r.system=l.getValue();break;case"adtitle":r.title=l.getValue();break;case"adverifications":for(var o=l.getChildren("verification"),c=0;c<o.length;c++)o[c].getChildren("javascriptresource").length&&r.adverifications.push(o[c].getValue());break;case"viewableimpression":var u=l.getChildren("viewable")[0];u&&u.getValue()&&(r.viewabletracker=u.getValue());break;case"impression":var p=l.getValue();p.length&&r.impression.push(p);break;case"extensions":for(var d=l.getChildren("extension"),c=0;c<d.length;c++)r.extensions.hasOwnProperty(d[c].getAttribute("type"))?r.extensions[d[c].getAttribute("type")].push(d[c].getValue()):r.extensions[d[c].getAttribute("type")]=[d[c].getValue()];break;case"error":var p=l.getValue();p.length&&r.error.push(p);break;case"creatives":var g=l.getChildren("creative");r.creativeNodes=g;break;case"vastadtaguri":var p=l.getValue();p.length&&r.wrappers.push(p)}}}return r},e.exports=t},function(e,r){var t={};t.parse=function(e){var r={id:null,universalAdId:null,adId:null,type:null},t=e.getAttribute("id");t&&(r.id=t);var a=e.getAttribute("adId");a&&(r.adId=a);var n=e.getChildren("UniversalAdId");if(n.length){var i=n[0].getAttribute("idRegistry"),s=n[0].getValue();r.universalAdId=i+"-"+s}var l=e.getChildren();if(l.length)for(var o=0;o<l.length;o++){var c=l[o];switch(c.getTagName()){case"linear":r.type="linear";var u=this.parseLinear(c);for(var p in u)r[p]=u[p];break;case"companionads":r.type="companion";var d=this.parseCompanion(c);for(var p in d)r[p]=d[p]}}return r},t.parseCompanion=function(e){for(var r={companionId:null,height:null,width:null,iframeResource:null,companionClickthrough:null},t=e.getChildren(),a=0;a<t.length;a++){var n=t[a];r.companionId=n.getAttribute("id"),r.width=n.getAttribute("width"),r.height=n.getAttribute("height");for(var i=n.getChildren(),a=0;a<i.length;a++)switch(i[a].getTagName()){case"iframeresource":var s=i[a].getValue();r.iframeResource=s;break;case"companionclickthrough":var l=i[a].getValue();r.companionClickthrough=l}}return r},t.parseLinear=function(e){for(var r={adParameters:null,duration:null,skipOffset:null,mediaFiles:[],trackingEvents:null,videoClicks:null},t=e.getChildren(),a=0;a<t.length;a++){var n=t[a];switch(n.getTagName()){case"duration":var i=n.getValue();r.duration=this.convertTimeToMs(i);break;case"trackingevents":r.trackingEvents=this.parseTrackingEvents(n);break;case"mediafiles":r.mediaFiles=this.parseMediaFiles(n);break;case"adparameters":r.adParameters=n.getValue();break;case"videoclicks":r.videoClicks=this.parseVideoClicks(n)}}return r},t.parseTrackingEvents=function(e){for(var r={playback:{start:[],firstQuartile:[],midpoint:[],thirdQuartile:[],complete:[],progress:{}},userActions:{mute:[],unmute:[],pause:[],resume:[],rewind:[],skip:[],playerExpand:[],playerCollapse:[]}},t=e.getChildren("tracking"),a=0;a<t.length;a++){var n=t[a],i=n.getAttribute("event");switch(i){case"start":case"firstQuartile":case"midpoint":case"thirdQuartile":case"complete":var s=n.getValue();s.length&&r.playback[i].push(s);break;case"progress":var l=n.getAttribute("offset"),s=n.getValue();null!=l&&s.length&&(r.playback.progress[l]||(r.playback.progress[l]=[]),r.playback.progress[l].push(s));break;case"mute":case"unmute":case"pause":case"resume":case"rewind":case"skip":case"playerExpand":case"playerCollapse":var s=n.getValue();s.length&&r.userActions[i].push(s)}}return r},t.parseMediaFiles=function(e){for(var r=[],t=e.getChildren("mediafile"),a=0;a<t.length;a++){var n=t[a],i={height:null,width:null,type:null,delivery:null,bitrate:null,url:null,apiFramework:null},s=n.getAttribute("height");s&&(i.height=parseInt(s));var l=n.getAttribute("width");l&&(i.width=parseInt(l));var o=n.getAttribute("type");o&&(i.type=o);var c=n.getAttribute("delivery");c&&(i.delivery=c);var u=n.getAttribute("apiFramework");u&&(i.apiFramework=u);var p=n.getAttribute("bitrate"),d=n.getAttribute("minbitrate");p?i.bitrate=parseInt(p):d&&(i.bitrate=parseInt(d));var g=n.getValue();g.length&&(i.url=g,r.push(i))}return r},t.parseVideoClicks=function(e){for(var r={clickThrough:null,clickTracking:[],customClick:null},t=e.getChildren(),a=0;a<t.length;a++){var n=t[a];switch(n.getTagName()){case"clickthrough":var i=n.getValue();i.length&&null===r.clickThrough&&(r.clickThrough=i);break;case"clicktracking":var i=n.getValue();i.length&&r.clickTracking.push(i);break;case"customclick":var i=n.getValue();i.length&&null===r.customClick&&(r.customClick=i)}}return r},t.convertTimeToMs=function(e){e=e.trim();var r=null,t=/^(\d{2}):(\d{2}):(\d{2})(?:\.(\d{3}))?$/.exec(e);return t&&t.length&&(r=0,r+=60*parseInt(t[1])*60*1e3,r+=60*parseInt(t[2])*1e3,r+=1e3*parseInt(t[3]),null!=t[4]&&(r+=parseInt(t[4]))),r},t.mergeTracking=function(e,r){e||(e={}),r||(r={});var t,a,n,i={playback:{start:[],firstQuartile:[],midpoint:[],thirdQuartile:[],complete:[],progress:{}},userActions:{mute:[],unmute:[],pause:[],resume:[],rewind:[],skip:[],playerExpand:[],playerCollapse:[]}},s=["start","firstQuartile","midpoint","thirdQuartile","complete"],l=["mute","unmute","pause","resume","rewind","skip","playerExpand","playerCollapse"];for(a=0;a<s.length;a++){if(t=s[a],e.playback&&e.playback[t])for(n=0;n<e.playback[t].length;n++)i.playback[t].push(e.playback[t][n]);if(r.playback&&r.playback[t])for(n=0;n<r.playback[t].length;n++)i.playback[t].push(r.playback[t][n])}for(a=0;a<l.length;a++){if(t=l[a],e.userActions&&e.userActions[t])for(n=0;n<e.userActions[t].length;n++)i.userActions[t].push(e.userActions[t][n]);if(r.userActions&&r.userActions[t])for(n=0;n<r.userActions[t].length;n++)i.userActions[t].push(r.userActions[t][n])}if(e.playback&&e.playback.progress)for(t in e.playback.progress)if(void 0!==t)for(i.playback.progress[t]||(i.playback.progress[t]=[]),a=0;a<e.playback.progress[t].length;a++)i.playback.progress[t].push(e.playback.progress[t][a]);if(r.playback&&r.playback.progress)for(t in r.playback.progress)if(void 0!==t)for(i.playback.progress[t]||(i.playback.progress[t]=[]),a=0;a<r.playback.progress[t].length;a++)i.playback.progress[t].push(r.playback.progress[t][a]);return i},t.mergeVideoClicks=function(e,r){e||(e={}),r||(r={});var t={clickThrough:null,clickTracking:[],customClick:null};return r.clickThrough?t.clickThrough=r.clickThrough:e.clickThrough&&(t.clickThrough=e.clickThrough),r.customClick?t.customClick=r.customClick:e.customClick&&(t.customClick=e.customClick),e.clickTracking&&e.clickTracking.length&&(t.clickTracking=t.clickTracking.concat(e.clickTracking)),r.clickTracking&&r.clickTracking.length&&(t.clickTracking=t.clickTracking.concat(r.clickTracking)),t},e.exports=t}]);